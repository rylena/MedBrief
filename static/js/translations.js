const translations = {
    en: {
        nav_home: "Home",
        nav_assistant: "Ask Assistant",
        nav_history: "History",
        nav_login: "Login",
        nav_signup: "Sign Up",
        nav_logout: "Logout",

        home_title: "MedBrief",
        home_subtitle: "Translate Medical Notes to Simple English",

        label_medical_notes: "Enter Medical Notes",
        placeholder_medical_notes: "Paste your medical notes here...",
        label_upload_pdf: "Or Upload PDF/Image",
        label_privacy: "Enable Privacy Filter (Redact Names/Dates)",
        label_translate_to: "Translate summary to:",

        btn_translate: "Translate to Simple English",
        btn_translating: "Translating...",
        btn_send: "Send",
        btn_play_audio: "Play Audio",

        result_summary: "Summary",
        result_key_terms: "Key Medical Terms",

        chat_title: "Medical Assistant",
        chat_subtitle: "Ask questions about your medical note",
        chat_placeholder: "Ask a question...",
        chat_no_context: "I don't see any recent medical note to discuss. Please go to the Home page and translate a note first.",
        chat_error: "Error connecting to assistant.",
        chat_sorry: "Sorry, I couldn't process that.",

        history_title: "Your History",
        history_empty: "No summaries yet. Translate a medical note to get started!",

        login_title: "Login to MedBrief",
        login_email: "Email",
        login_password: "Password",
        login_btn: "Login",
        login_no_account: "Don't have an account?",
        login_signup_link: "Sign up here",

        signup_title: "Create Account",
        signup_email: "Email",
        signup_password: "Password",
        signup_btn: "Sign Up",
        signup_have_account: "Already have an account?",
        signup_login_link: "Login here",

        error_no_text: "Please enter some medical notes or upload a PDF.",
        loading_image: "Analyzing Image...",
        loading_pdf: "Processing PDF...",
        loading_translating: "Translating..."
    },

    es: {
        nav_home: "Inicio",
        nav_assistant: "Asistente",
        nav_history: "Historial",
        nav_login: "Iniciar Sesión",
        nav_signup: "Registrarse",
        nav_logout: "Cerrar Sesión",

        home_title: "MedBrief",
        home_subtitle: "Traduce Notas Médicas a Lenguaje Simple",

        label_medical_notes: "Ingrese Notas Médicas",
        placeholder_medical_notes: "Pegue sus notas médicas aquí...",
        label_upload_pdf: "O Suba PDF/Imagen",
        label_privacy: "Activar Filtro de Privacidad (Ocultar Nombres/Fechas)",
        label_translate_to: "Traducir resumen a:",

        btn_translate: "Traducir a Lenguaje Simple",
        btn_translating: "Traduciendo...",
        btn_send: "Enviar",
        btn_play_audio: "Reproducir Audio",

        result_summary: "Resumen",
        result_key_terms: "Términos Médicos Clave",

        chat_title: "Asistente Médico",
        chat_subtitle: "Haga preguntas sobre su nota médica",
        chat_placeholder: "Haga una pregunta...",
        chat_no_context: "No veo ninguna nota médica reciente para discutir. Vaya a la página de inicio y traduzca una nota primero.",
        chat_error: "Error al conectar con el asistente.",
        chat_sorry: "Lo siento, no pude procesar eso.",

        history_title: "Su Historial",
        history_empty: "Aún no hay resúmenes. ¡Traduzca una nota médica para comenzar!",

        login_title: "Iniciar Sesión en MedBrief",
        login_email: "Correo Electrónico",
        login_password: "Contraseña",
        login_btn: "Iniciar Sesión",
        login_no_account: "¿No tiene una cuenta?",
        login_signup_link: "Regístrese aquí",

        signup_title: "Crear Cuenta",
        signup_email: "Correo Electrónico",
        signup_password: "Contraseña",
        signup_btn: "Registrarse",
        signup_have_account: "¿Ya tiene una cuenta?",
        signup_login_link: "Inicie sesión aquí",

        error_no_text: "Por favor ingrese notas médicas o suba un PDF.",
        loading_image: "Analizando Imagen...",
        loading_pdf: "Procesando PDF...",
        loading_translating: "Traduciendo..."
    },

    fr: {
        nav_home: "Accueil",
        nav_assistant: "Assistant",
        nav_history: "Historique",
        nav_login: "Connexion",
        nav_signup: "S'inscrire",
        nav_logout: "Déconnexion",

        home_title: "MedBrief",
        home_subtitle: "Traduire les Notes Médicales en Langage Simple",

        label_medical_notes: "Entrez les Notes Médicales",
        placeholder_medical_notes: "Collez vos notes médicales ici...",
        label_upload_pdf: "Ou Télécharger PDF/Image",
        label_privacy: "Activer le Filtre de Confidentialité (Masquer Noms/Dates)",
        label_translate_to: "Traduire le résumé en:",

        btn_translate: "Traduire en Langage Simple",
        btn_translating: "Traduction...",
        btn_send: "Envoyer",
        btn_play_audio: "Lire l'Audio",

        result_summary: "Résumé",
        result_key_terms: "Termes Médicaux Clés",

        chat_title: "Assistant Médical",
        chat_subtitle: "Posez des questions sur votre note médicale",
        chat_placeholder: "Posez une question...",
        chat_no_context: "Je ne vois aucune note médicale récente à discuter. Veuillez aller à la page d'accueil et traduire une note d'abord.",
        chat_error: "Erreur de connexion à l'assistant.",
        chat_sorry: "Désolé, je n'ai pas pu traiter cela.",

        history_title: "Votre Historique",
        history_empty: "Pas encore de résumés. Traduisez une note médicale pour commencer!",

        login_title: "Connexion à MedBrief",
        login_email: "E-mail",
        login_password: "Mot de passe",
        login_btn: "Connexion",
        login_no_account: "Vous n'avez pas de compte?",
        login_signup_link: "Inscrivez-vous ici",

        signup_title: "Créer un Compte",
        signup_email: "E-mail",
        signup_password: "Mot de passe",
        signup_btn: "S'inscrire",
        signup_have_account: "Vous avez déjà un compte?",
        signup_login_link: "Connectez-vous ici",

        error_no_text: "Veuillez entrer des notes médicales ou télécharger un PDF.",
        loading_image: "Analyse de l'Image...",
        loading_pdf: "Traitement du PDF...",
        loading_translating: "Traduction..."
    },

    hi: {
        nav_home: "होम",
        nav_assistant: "सहायक",
        nav_history: "इतिहास",
        nav_login: "लॉगिन",
        nav_signup: "साइन अप",
        nav_logout: "लॉगआउट",

        home_title: "MedBrief",
        home_subtitle: "चिकित्सा नोट्स को सरल भाषा में अनुवाद करें",

        label_medical_notes: "चिकित्सा नोट्स दर्ज करें",
        placeholder_medical_notes: "अपने चिकित्सा नोट्स यहां पेस्ट करें...",
        label_upload_pdf: "या PDF/छवि अपलोड करें",
        label_privacy: "गोपनीयता फ़िल्टर सक्षम करें (नाम/तारीखें छिपाएं)",
        label_translate_to: "सारांश का अनुवाद करें:",

        btn_translate: "सरल भाषा में अनुवाद करें",
        btn_translating: "अनुवाद हो रहा है...",
        btn_send: "भेजें",
        btn_play_audio: "ऑडियो चलाएं",

        result_summary: "सारांश",
        result_key_terms: "प्रमुख चिकित्सा शब्द",

        chat_title: "चिकित्सा सहायक",
        chat_subtitle: "अपने चिकित्सा नोट के बारे में प्रश्न पूछें",
        chat_placeholder: "एक प्रश्न पूछें...",
        chat_no_context: "मुझे चर्चा करने के लिए कोई हालिया चिकित्सा नोट नहीं दिख रहा है। कृपया होम पेज पर जाएं और पहले एक नोट का अनुवाद करें।",
        chat_error: "सहायक से कनेक्ट करने में त्रुटि।",
        chat_sorry: "क्षमा करें, मैं इसे संसाधित नहीं कर सका।",

        history_title: "आपका इतिहास",
        history_empty: "अभी तक कोई सारांश नहीं। शुरू करने के लिए एक चिकित्सा नोट का अनुवाद करें!",

        login_title: "MedBrief में लॉगिन करें",
        login_email: "ईमेल",
        login_password: "पासवर्ड",
        login_btn: "लॉगिन",
        login_no_account: "खाता नहीं है?",
        login_signup_link: "यहां साइन अप करें",

        signup_title: "खाता बनाएं",
        signup_email: "ईमेल",
        signup_password: "पासवर्ड",
        signup_btn: "साइन अप",
        signup_have_account: "पहले से खाता है?",
        signup_login_link: "यहां लॉगिन करें",

        error_no_text: "कृपया कुछ चिकित्सा नोट्स दर्ज करें या PDF अपलोड करें।",
        loading_image: "छवि का विश्लेषण हो रहा है...",
        loading_pdf: "PDF संसाधित हो रहा है...",
        loading_translating: "अनुवाद हो रहा है..."
    }
};

const languageNames = {
    'en': 'English',
    'es': 'Spanish',
    'fr': 'French',
    'de': 'German',
    'it': 'Italian',
    'pt': 'Portuguese',
    'ru': 'Russian',
    'zh': 'Chinese',
    'ja': 'Japanese',
    'ko': 'Korean',
    'ar': 'Arabic',
    'hi': 'Hindi',
    'bn': 'Bengali',
    'ur': 'Urdu',
    'vi': 'Vietnamese',
    'th': 'Thai',
    'tr': 'Turkish',
    'pl': 'Polish',
    'nl': 'Dutch',
    'sv': 'Swedish'
};

function getCurrentLanguage() {
    return sessionStorage.getItem('selectedLanguage') || 'en';
}

function setLanguage(lang) {
    sessionStorage.setItem('selectedLanguage', lang);
    applyTranslations(lang);
}

function applyTranslations(lang) {
    const t = translations[lang] || translations['en'];

    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (t[key]) {
            if (element.tagName === 'INPUT' && element.type !== 'submit') {
                element.placeholder = t[key];
            } else {
                element.textContent = t[key];
            }
        }
    });

    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (t[key]) {
            element.placeholder = t[key];
        }
    });

    if (lang === 'ar' || lang === 'ur') {
        document.body.setAttribute('dir', 'rtl');
    } else {
        document.body.setAttribute('dir', 'ltr');
    }
}

function translate(key, lang = null) {
    const currentLang = lang || getCurrentLanguage();
    const t = translations[currentLang] || translations['en'];
    return t[key] || key;
}

document.addEventListener('DOMContentLoaded', () => {
    const currentLang = getCurrentLanguage();
    applyTranslations(currentLang);

    const langSelect = document.getElementById('language-select');
    if (langSelect) {
        langSelect.value = currentLang;
        langSelect.addEventListener('change', (e) => {
            setLanguage(e.target.value);
        });
    }
});
